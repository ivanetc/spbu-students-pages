## –í–≤–µ–¥–µ–Ω–∏–µ: —ç–≤–æ–ª—é—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ü–û ‚Äî —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ –∫–æ–¥, –Ω–æ –∏ –ø—Ä–æ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞. –ö–æ–≥–¥–∞ –ø—Ä–æ–µ–∫—Ç—ã —Ä–∞—Å—Ç—É—Ç, —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Å—ë —Å–ª–æ–∂–Ω–µ–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ. –ò–º–µ–Ω–Ω–æ –∑–¥–µ—Å—å –ø–æ—è–≤–ª—è—é—Ç—Å—è Domain-Driven Development (DDD) –∏ Event-Driven Development (EDD) ‚Äî –¥–≤–∞ –º–æ—â–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞, –ø–æ–º–æ–≥–∞—é—â–∏—Ö —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥–∏–±–∫–∏–µ, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–µ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.



## 1. Domain-Driven Development (DDD)

### 1.1 –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**DDD** ‚Äî –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É. –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è ‚Äî —Å—Ç—Ä–æ–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –≤–æ–∫—Ä—É–≥ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏.

![](../../resources/lectures/2025-spring/ddd_example_1.jpg)

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**

- **Ubiquitous Language** ‚Äî –µ–¥–∏–Ω—ã–π —è–∑—ã–∫ –º–µ–∂–¥—É –±–∏–∑–Ω–µ—Å–æ–º –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π.
- **Bounded Context** ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –≤ –º–æ–¥–µ–ª–∏.
- **Entities / Value Objects** ‚Äî —Å—É—â–Ω–æ—Å—Ç–∏ —Å –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å—é –∏ –æ–±—ä–µ–∫—Ç—ã-–∑–Ω–∞—á–µ–Ω–∏—è.
- **Aggregates** ‚Äî –ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã —Å—É—â–Ω–æ—Å—Ç–µ–π.
- **Repositories** ‚Äî –¥–æ—Å—Ç—É–ø –∫ –∞–≥—Ä–µ–≥–∞—Ç–∞–º.

![](../../resources/lectures/2025-spring/ddd_example_1.png)


### 1.2 –ü—Ä–∏–º–µ—Ä:

```java
public class Order {
    private final OrderId id;
    private final List<OrderItem> items;
    private OrderStatus status;

    public void complete() {
        if (this.status != OrderStatus.PAID) {
            throw new IllegalStateException("Order must be paid before completing.");
        }
        this.status = OrderStatus.COMPLETED;
        DomainEvents.raise(new OrderCompletedEvent(this.id));
    }
}
```

### üìå Ubiquitous Language

- –ò—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Ä–º–∏–Ω—ã –±–∏–∑–Ω–µ—Å–∞ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö –∫–ª–∞—Å—Å–æ–≤, –º–µ—Ç–æ–¥–æ–≤, –ø–æ–ª–µ–π.
- –ü—Ä–∏–º–µ—Ä:
```java
public class Order {
    private OrderStatus status;
    public void complete() { ... }
}
```

### üìå Entities / Value Objects / Aggregates

| –¢–∏–ø           | –ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å | –ü—Ä–∏–º–µ—Ä         |
|---------------|--------------|----------------|
| Entity        | –î–∞           | Order          |
| Value Object  | –ù–µ—Ç          | Money, Address |
| Aggregate     | –î–∞           | Order + Items  |

### üìå Bounded Context

- –í—ã–¥–µ–ª—è–π –º–æ–¥—É–ª–∏ –ø–æ –±–∏–∑–Ω–µ—Å-–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º.
- –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```
src/
‚îú‚îÄ‚îÄ payments/
‚îú‚îÄ‚îÄ orders/
```


## 2. Event-Driven Development (EDD)

![](../../resources/lectures/2025-spring/edd_example.png)


### –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**EDD** ‚Äî —ç—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è. 
–í EDD —Å–æ–±—ã—Ç–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–ª–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –º–æ–≥—É—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å 
–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥–∏–±–∫–∏–µ, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–µ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã.

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- **Event** ‚Äî —Å–æ–±—ã—Ç–∏–µ.
- **Producer** ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ.
- **Consumer** ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ.
- **Event Bus / Broker** ‚Äî –¥–æ—Å—Ç–∞–≤–∫–∞ (Kafka, RabbitMQ).

### –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å EDD?

EDD –∏–º–µ–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç –µ–≥–æ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–º –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å**

–í—Å–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–µ —Ä–∞–±–æ—Ç–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ. –≠—Ç–æ –≤–∞–∂–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º, –≥–¥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –∑–∞–º–µ–¥–ª–∏—Ç—å —Ä–∞–±–æ—Ç—É.

- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**

–ü–æ—Å–∫–æ–ª—å–∫—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è, –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ. –í —Å–ª—É—á–∞–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã.

- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**

–°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –≤ —Å–ª—É—á–∞–µ –æ—Ç–∫–∞–∑–∞ –æ–¥–Ω–æ–≥–æ –∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞. –í —Å–ª—É—á–∞–µ –æ—Ç–∫–∞–∑–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è —Å–æ–±—ã—Ç–∏—è, –æ–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –ø–æ–∑–∂–µ.

- **–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**

–°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ—ë –∏–¥–µ–∞–ª—å–Ω–æ–π –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Ç—Ä–µ–±—É—é—â–∏—Ö —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏–ª–∏ –æ–Ω–ª–∞–π–Ω-–∏–≥—Ä.

- **–ì–∏–±–∫–æ—Å—Ç—å**

–°–∏—Å—Ç–µ–º—ã, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ —Å–æ–±—ã—Ç–∏—è—Ö, –ø—Ä–æ—â–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å, –ø–æ—Å–∫–æ–ª—å–∫—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –∏–ª–∏ —É–¥–∞–ª–µ–Ω—ã –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç–µ–π —Å–∏—Å—Ç–µ–º—ã.

### –ü—Ä–∏–Ω—Ü–∏–ø—ã Event-Driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –ü—Ä–∏–º–µ—Ä:

```java
public class OrderPaidEvent {
    private final UUID orderId;
    public OrderPaidEvent(UUID orderId) { this.orderId = orderId; }
    public UUID getOrderId() { return orderId; }
}

@Component
public class OrderPaidEventHandler {
    @EventListener
    public void handle(OrderPaidEvent event) {
        // –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è
    }
}
```

1. **–°–æ–±—ã—Ç–∏—è**:
–°–æ–±—ã—Ç–∏–µ (Event) ‚Äî —ç—Ç–æ —Ñ–∞–∫—Ç –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ, –∫–æ—Ç–æ—Ä–æ–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –û–±—ã—á–Ω–æ —Å–æ–±—ã—Ç–∏—è —è–≤–ª—è—é—Ç—Å—è –Ω–µ–æ–±—Ä–∞—Ç–∏–º—ã–º–∏. –ü—Ä–∏–º–µ—Ä: –∑–∞–∫–∞–∑ –±—ã–ª –æ–ø–ª–∞—á–µ–Ω.

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏–π (Event Producer):**
–≠—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏–π —Å–æ–±—ã—Ç–∏–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ OrderPaid.

3. **–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏–π (Event Consumer):**
–≠—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å–æ–±—ã—Ç–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏ –º–æ–∂–µ—Ç —Å–ª—É—à–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ OrderPaid –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞.

4. **–®–∏–Ω–∞ —Å–æ–±—ã—Ç–∏–π (Event Bus):**
–≠—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π –æ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –∫ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—é. –®–∏–Ω–∞ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–π –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã. –ü—Ä–∏–º–µ—Ä: Kafka, RabbitMQ.

5. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:**
–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, –≥–¥–µ –æ–¥–∏–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥—Ä—É–≥–æ–≥–æ, –≤ EDD –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —É—Å–∫–æ—Ä–∏—Ç—å –æ—Ç–∫–ª–∏–∫.

## 3. –°–≤—è–∑—å DDD –∏ EDD

| DDD                                 | EDD                              |
|------------------------------------|----------------------------------|
| –ú–æ–¥–µ–ª–∏—Ä—É–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É           | –ú–æ–¥–µ–ª–∏—Ä—É–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ        |
| Domain Events                      | –†–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è               |
| –í–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–æ–≤                    | –ú–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏                  |
| Bounded Context                    | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è           |


## 4. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ß—Ç–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å:

#### –í DDD:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Ubiquitous Language**.
- –í—ã–¥–µ–ª—è—Ç—å **Entities**, **Value Objects**, **Aggregates**.
- –î–µ–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–∞ **Bounded Contexts**.

#### –í EDD:
- –û—Å–≤–∞–∏–≤–∞—Ç—å Spring Events, Kafka.
- –°—Ç—Ä–æ–∏—Ç—å –º–æ–¥—É–ª–∏ –≤–æ–∫—Ä—É–≥ —Ä–µ–∞–∫—Ü–∏–π –Ω–∞ —Å–æ–±—ã—Ç–∏—è.


## Apache Kafka

**Apache Kafka** ‚Äî —ç—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. Kafka –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç 
–ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏, –ø–µ—Ä–µ–¥–∞—á–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∫—Ä—É–ø–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö. –û–Ω–∞ —Å—Ç–∞–ª–∞ –ø–æ–ø—É–ª—è—Ä–Ω–æ–π 
–≤ –º–∏—Ä–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –∏ —Å–∏—Å—Ç–µ–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–≤–æ–µ–π –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏, 
–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Kafka
- **Producer**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Kafka. –û–Ω–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–º.

- **Consumer**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —á–∏—Ç–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Kafka. –ö–∞–∂–¥—ã–π –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–º.

- **Topic**: –ö–∞–Ω–∞–ª, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è. Kafka –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ç–æ–ø–∏–∫–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π.

- **Partition**: –ö–∞–∂–¥—ã–π —Ç–æ–ø–∏–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–±–∏—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–¥–µ–ª–æ–≤ (–ø–∞—Ä—Ç–∏—Ü–∏–π), —á—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏.

- **Broker**: –°–µ—Ä–≤–µ—Ä—ã Kafka, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø—Ä–æ–¥—é—Å–µ—Ä–æ–≤ –∏ –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –∏—Ö –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º. Kafka –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –±—Ä–æ–∫–µ—Ä–æ–≤ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏.

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã Kafka

**2.1. –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π**

–ü—Ä–æ–¥—é—Å–µ—Ä—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –¥–∞–Ω–Ω—ã–µ –≤ Kafka. –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ —Ç–æ–ø–∏–∫. –°–æ–æ–±—â–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ —Ç–æ–ø–∏–∫–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ 
–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–º –Ω–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è.

**2.2. –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**

Kafka —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –¥–∏—Å–∫–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ —á–∏—Ç–∞—Ç—å –∏—Ö, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–∞–Ω–Ω—ã–µ 
—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 7 –¥–Ω–µ–π, –Ω–æ —ç—Ç–æ—Ç —Å—Ä–æ–∫ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å.

**2.3. –ü–æ–¥–ø–∏—Å–∫–∞ –∏ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ**

–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Kafka –ø–æ –∑–∞–ø—Ä–æ—Å—É. –û–Ω–∏ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ª—é–±–æ–≥–æ —Å–º–µ—â–µ–Ω–∏—è (offset), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∏–ª–∏ –Ω–∞—á–∞—Ç—å —á—Ç–µ–Ω–∏–µ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ç–æ—á–∫–∏.

**2.4. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**

Kafka –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –ø–∞—Ä—Ç–∏—Ü–∏–π. –ö–∞–∂–¥–∞—è –ø–∞—Ä—Ç–∏—Ü–∏—è –∏–º–µ–µ—Ç –æ–¥–∏–Ω –ª–∏–¥–µ—Ä –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ–ª–ª–æ–≤–µ—Ä–æ–≤. –õ–∏–¥–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏ —Ä–µ–ø–ª–∏—Ü–∏—Ä—É–µ—Ç –∏—Ö –Ω–∞ —Ñ–æ–ª–ª–æ–≤–µ—Ä–æ–≤. –í —Å–ª—É—á–∞–µ —Å–±–æ—è –ª–∏–¥–µ—Ä–∞ –æ–¥–∏–Ω –∏–∑ —Ñ–æ–ª–ª–æ–≤–µ—Ä–æ–≤ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º –ª–∏–¥–µ—Ä–æ–º.

**2.5. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**

Kafka –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –±—Ä–æ–∫–µ—Ä–æ–≤. –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –±—Ä–æ–∫–µ—Ä –º–æ–∂–µ—Ç –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ –∏ —Ç–æ–ø–∏–∫–∏.

![](../../resources/lectures/2025-spring/kafka.jpg)

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Kafka —Å Spring

#### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è Spring
–î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Apache Kafka —Å Spring –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```groovy
dependencies {
    implementation 'org.springframework.boot:spring-boot-starter'
    implementation 'org.springframework.kafka:spring-kafka'

    testImplementation 'org.springframework.kafka:spring-kafka-test'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Kafka –≤ Spring
–í Spring –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å KafkaTemplate –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ @KafkaListener –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–¥—é—Å–µ—Ä–∞:**
```java
@Configuration
public class KafkaConfig {

    @Bean
    public ProducerFactory<String, String> producerFactory() {
        Map<String, Object> producerProps = new HashMap<>();
        producerProps.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:9092");
        producerProps.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
        producerProps.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
        return new DefaultKafkaProducerFactory<>(producerProps);
    }

    @Bean
    public KafkaTemplate<String, String> kafkaTemplate() {
        return new KafkaTemplate<>(producerFactory());
    }
}
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è:**

```java
@Configuration
@EnableKafka
public class KafkaConsumerConfig {

    @Bean
    public ConsumerFactory<String, String> consumerFactory() {
        Map<String, Object> consumerProps = new HashMap<>();
        consumerProps.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:9092");
        consumerProps.put(ConsumerConfig.GROUP_ID_CONFIG, "test-group");
        consumerProps.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
        consumerProps.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
        return new DefaultKafkaConsumerFactory<>(consumerProps);
    }

    @Bean
    public ConcurrentMessageListenerContainer<String, String> messageListenerContainer() {
        return new ConcurrentMessageListenerContainer<>(consumerFactory(), "test-topic");
    }
}
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—é—Å–µ—Ä–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
```java
@Service
public class KafkaProducer {

    private final KafkaTemplate<String, String> kafkaTemplate;

    @Autowired
    public KafkaProducer(KafkaTemplate<String, String> kafkaTemplate) {
        this.kafkaTemplate = kafkaTemplate;
    }

    public void sendMessage(String message) {
        kafkaTemplate.send("test-topic", message);
    }
}
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
```java
@Service
public class KafkaConsumer {

    @KafkaListener(topics = "test-topic", groupId = "test-group")
    public void listen(String message) {
        System.out.println("Received message: " + message);
    }
}
```

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Kafka:

```java
@RestController
public class KafkaController {

    private final KafkaProducer kafkaProducer;

    @Autowired
    public KafkaController(KafkaProducer kafkaProducer) {
        this.kafkaProducer = kafkaProducer;
    }

    @PostMapping("/send")
    public ResponseEntity<String> sendMessage(@RequestBody String message) {
        kafkaProducer.sendMessage(message);
        return ResponseEntity.ok("Message sent to Kafka");
    }
}

```

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–¥–Ω—è—Ç—å –∫–∞—Ñ–∫—É –ª–æ–∫–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π docker-compose —Ñ–∞–π–ª:
```yml
version: '3'

services:
  zookeeper:
    image: wurstmeister/zookeeper:3.4.6
    container_name: zookeeper
    ports:
      - "2181:2181"
    environment:
      - ZOOKEEPER_CLIENT_PORT=2181
      - ZOOKEEPER_TICK_TIME=2000
    networks:
      - kafka-net

  kafka:
    image: wurstmeister/kafka:latest
    container_name: kafka
    ports:
      - "9093:9093"
    environment:
      - KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
      - KAFKA_ADVERTISED_LISTENER_NAME=PLAINTEXT
      - KAFKA_LISTENER_SECURITY_PROTOCOL=PLAINTEXT
      - KAFKA_LISTENER_NAME_PLAINTEXT_PORT=9093
      - KAFKA_LISTENER_NAME_PLAINTEXT_LISTENER_SECURITY_PROTOCOL=PLAINTEXT
      - KAFKA_LISTENER_NAME_PLAINTEXT_LISTENER_TCP_PORT=9093
      - KAFKA_LISTENER_NAME_PLAINTEXT_LISTENER_PORT=9093
      - KAFKA_LISTENER_NAME_PLAINTEXT_LISTENER_PROTOCOL=PLAINTEXT
      - KAFKA_LISTENER_PORT=9093
      - KAFKA_LISTENER_NAME_PLAINTEXT_LISTENER_TYPE=TCP
      - KAFKA_LISTENER_PLAINTEXT=PLAIN
      - KAFKA_LISTENER_PORT=9093
    networks:
      - kafka-net
    depends_on:
      - zookeeper

  kafdrop:
    image: obsidiandynamics/kafdrop:latest
    container_name: kafdrop
    ports:
      - "9000:9000"
    environment:
      - KAFKA_BROKERCONNECT=kafka:9093
    networks:
      - kafka-net

networks:
  kafka-net:
    driver: bridge

```


## –†–µ—Å—É—Ä—Å—ã

- Eric Evans ‚Äî *Domain-Driven Design*.
- Vaughn Vernon ‚Äî *Implementing DDD*.
- https://kafka.apache.org/
- https://docs.spring.io/
- Spring Kafka ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Kafka —Å Spring: https://docs.spring.io/spring-kafka/docs/current/reference/html/
- Apache Kafka ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç: https://kafka.apache.org/
- Reactive Programming ‚Äî –∏–∑—É—á–µ–Ω–∏–µ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–±—ã—Ç–∏–π: https://www.reactivemanifesto.org/
- Designing Event-Driven Systems ‚Äî –∫–Ω–∏–≥–∞ Ben Stopford: https://www.oreilly.com/library/view/designing-event-driven-systems/9781492038254/

